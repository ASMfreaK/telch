<div class="col-sm-12">
  <form class="toolbar-pf-actions">
    <div class="form-group toolbar-pf-filter">
      <label class="sr-only" for="filter">Description</label>
      <div class="input-group">
        <div class="input-group-btn">
          <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Description <span class="caret"></span></button>
          <ul class="dropdown-menu">
            <li class="selected"><a href="#">Description</a></li>
            <li><a href="#">Project</a></li>
            <li><a href="#">Status</a></li>
          </ul>
        </div>
        <input type="text" class="form-control" id="filter" placeholder="Filter By ...">
      </div>
    </div>
    <div class="form-group">
      <div class="dropdown btn-group">
        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Urgency <span class="caret"></span></button>
        <ul class="dropdown-menu">
          <li class="selected"><a href="#">Urgency</a></li>
          <li><a href="#">Project</a></li>
          <li><a href="#">Priority</a></li>
          <li><a href="#">Due</a></li>
          <li><a href="#">Last Modified</a></li>
        </ul>
      </div>
      <button class="btn btn-link" type="button">
        <span class="fa fa-sort-alpha-asc"></span>
      </button>
    </div>
    <div class="form-group toolbar-pf-find">
      <button class="btn btn-link btn-find" type="button">
        <span class="fa fa-search"></span>
      </button>
    </div>
  </form>
  <div class="row toolbar-pf-results">
    <div class="col-sm-12">
      <h5 id='total'></h5>
      <p>Active filters:</p>
      <ul class="list-inline">
        {% for key, value in filters.items() %}
          <li>
            <span class="label label-info">
              {{ key|capitalize }}: {{ value|capitalize }}
              <a href="#" id="filter_close_{{key}}" class='filter-close'><span class="pficon pficon-close"></span></a>
            </span>
          </li>
        {% endfor %}
      </ul>
      <p><a href="#" id="filter-clear">Clear All Filters</a></p>
    </div>
  </div>
</div>

<script>

function send_filter_updates(){
  console.log('send_filter_updates+');
  filter_value_str = JSON.stringify(document.filter_value);
  console.log('filter_value: '+filter_value_str);
  document.sock.send(filter_value_str);
  console.log('send_filter_updates-');
}

$(document).ready(function () {
  $('.filter-close').click(function () {
    console.log('filter-close+');
    id = $(this).attr('id');
    console.log('id: '+id);
    parts = id.split('_');
    filter_name = parts[parts.length - 1];
    console.log('filter_name: '+filter_name);
    delete document.filter_value[filter_name];
    send_filter_updates();
    console.log('filter-close-');
  });

  $('#filter-clear').click(function(){
    document.sock.send('{}');
  });
 });
</script>
